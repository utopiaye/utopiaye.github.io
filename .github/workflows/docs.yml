name: 部署 VuePress 到 GitHub Pages

# 触发条件：当推送到 main 分支时执行
on:
  push:
    branches: [ main ]  # 如果你用的是 master 分支，改为 master

jobs:
  deploy:
    runs-on: ubuntu-latest  # 使用 Ubuntu 系统运行

    steps:
      # 步骤 1：拉取代码到服务器
      - name: 拉取代码
        uses: actions/checkout@v4
        with:
          fetch-depth: 0  # 拉取完整历史

      # 步骤 2：安装 Node.js
      - name: 安装 Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 20  # 使用 Node.js 20 版本（可根据需要修改）

      # 步骤 3：安装依赖并构建
      - name: 安装依赖并构建
        run: |
          npm install  # 安装项目依赖
          npm run docs:build  # 执行构建命令，生成静态文件

      # 步骤 4：部署到 GitHub Pages
      - name: 部署到 GitHub Pages
        uses: peaceiris/actions-gh-pages@v4
        with:
          # 部署密钥（无需修改，GitHub 自动生成）
          github_token: ${{ secrets.GITHUB_TOKEN }}
          # 构建产物的路径（VuePress 构建后默认在 docs/.vuepress/dist）
          publish_dir: ./docs/.vuepress/dist
          # 部署到 gh-pages 分支（自动创建）
          publish_branch: gh-pages
